%本章探讨改进失效现象

\chapter{改进失效的风险}

在第\ref{chapter:优化潜力}章的证明过程中，我们通过添加项的方式对不等式进行放缩，从而证明了$\sum_{i=1}^N\xi_i > \xi$是严格成立的。但是这一推导过程中，我们默认了$z_\eta>0$。由$z_\eta$的定义可知
\[
z_\eta>0 \Longleftrightarrow \eta > 0.5
\]
也就是说，只有当企业设定的服务水平高于50\%时，才能够通过保留在制品库存降低企业库存总量。

当$\eta=0.5$时，有$z_\eta=0$，参考公式\ref{eq:改进前后库存比较i}的推导过程，可知此时$\sum_{i=1}^N\xi_i - \xi = 0$，即改进前后企业的总库存没有发生变化。

当$\eta<0.5$时，有$z_\eta<0$，参考公式\ref{eq:改进前后库存比较i}的推导过程，可以发现此时的不等式放缩方向是相反的，应该得到$\sum_{i=1}^N\xi_i - \xi < 0$，即改进后反而使得企业的总库存增加。

由此可见，当需求服从正态分布时，在某些服务水平下，将成品库存合并前移到在制品库存不仅没有起到改进效果，反而会使总库存增大。我们将这种情况称为改进失效。

本章将结合常用的需求分布函数，详细讨论改进失效现象与需求分布、服务水平等因素的关系。







\section{对称稳定分布的参数与改进失效的关系}

前面的部分主要考虑了需求为正态分布时，改进策略对库存总量的影响。之所以研究正态分布，是因为正态分布确实广泛存在于现实生活中。实际生产中的需求分布可能是各种各样的，甚至可能写不出解析式，但只要是方差有限的独立同分布，根据中心极限定理，在进行叠加的时候总会趋近于正态分布。而正态分布自身叠加仍是正态分布。因此，正态分布就像一个吸引域，从各种分布出发最终都落入正态分布。正态分布下的库存改进效果，也能在很大程度上反应实际的改进效果。

第\ref{chapter:优化潜力}章中已经提到，安全库存等于总库存与需求期望值之差。回顾公式\ref{eq:成品库存i}和\ref{eq:在制品库存i}可知，改进前和改进后的安全库存分别为$z_{\eta}\sum_{i=1}^n\sigma_i$和$z_\eta\sqrt{\sum_{i=1}^n\sigma_i^2}$。为了使考虑的问题更简单，我们假设所有的需求是独立同分布的$N(\mu,\sigma^2)$，则改进前和改进后的安全库存分别为$nz_\eta\sigma$和$\sqrt{n}z_\eta\sigma$。

当$\eta<0.5$的时候，安全库存是负值，这是实际生产中一般不会出现的情况。当$\eta>0.5$时，可以看到，$n$种成品合并之后的安全库存是单个成品安全库存的$\sqrt{n}$倍，而不合并的情况下则是单个成品的$n$倍。此时改进是一定有效果的。

(Feller 1971)提到，对称稳定分布有$f_{n,\alpha}(x)=f_\alpha(n^{1/\alpha}x)$的性质。也就是说，$n$个独立同分布的对称稳定分布的随机变量$X$相加，和的概率分布与随机变量$n^{1/\alpha}X$是相同的。而正态分布正是对称稳定分布取$\alpha=2$的一个特例。事实上，合并后安全库存是单个成品安全库存的$n^{1/\alpha}$倍的性质，同样出现在其他的对称稳定分布中。

稳定分布的概率密度函数为$f(x;\alpha,\beta,c,\mu)$，其中参数$\alpha\in(0,2]$，影响曲线的陡峭程度；$\beta\in[-1,1]$，影响曲线的偏斜程度；$c\in(0,+\infty)$，影响曲线的水平尺度；$\mu\in(-\infty,+\infty)$，影响曲线的水平中心。当$\beta=0$时，即为对称稳定分布。图
\ref{fig:对称稳定分布}展示了$\beta=0,c=1,\mu=0$的对称稳定分布在不同的$\alpha$取值下的图形，其中$\alpha=2$时即为正态分布。

\begin{figure}[htb]
\centering
\includegraphics[width=15cm]{stable.eps}
\caption{不同参数$\alpha$下的对称稳定分布}
\label{fig:对称稳定分布}
\end{figure}

广义中心极限定理指出，$n$个独立同分布的随机变量（方差可以无限）相加，最终会收敛到一个稳定分布。因此，和正态分布一样，稳定分布也广泛存在于实际生活中。（Newman 2005）的一系列实证分析证实了这一点。

假设单个成品需求服从对称稳定分布$f(x;\alpha,0,c,\mu)$，则它的安全库存服从对称稳定分布$f(x;\alpha,0,c,0)$。设此需求分布下，满足服务水平$\eta$需要的安全库存为$s$，$n$个成品需要的总安全库存是$ns$。根据（Feller）所述的性质可以推知，改进后需要的安全库存为$n^{1/\alpha}s$。$\eta>0.5$时$s>0$，故改进是否有效就取决于$\alpha$的取值。将改进前后的库存作比较：
\[
\frac{ns}{n^{1/\alpha}s} = n^{1-1/\alpha}
\]
其中$\alpha$的取值范围是$(0,2]$。

当$\alpha\in(1,2]$时，$n^{1-1/\alpha}>1$，改进前的库存大于改进后的库存，改进有效。

当$\alpha\in(0,1]$时，$n^{1-1/\alpha}\leq 1$，改进前的库存不大于改进后的库存，改进无效。









\section{右偏斜的需求分布一定存在改进失效的可能}

对称分布存在一个普遍的缺点——需求可能出现负值，因此我们在实际生产中也常常使用一些其他的分布函数来描述需求的分布。现实的需求不可能为负值，其概率密度函数一般不会有左侧的长尾。因此，需求分布一般都是右偏斜的。

（此处补充一些文献提到右偏斜的需求分布对substitution的影响）

假设有$n$种颜色的成品，其需求$D_i(i=1,2,\ldots,n)$独立同分布且该分布是右偏斜的，累积分布函数都为$F$，均值为$\mu$，方差为$\sigma^2$。将成品库存合并前移到在制品库存后，在制品的总需求为$D_n=\sum_{i=1}^nD_i$，其累积分布函数为$F_n$，均值为$n\mu$，方差为$n\sigma^2$。

设每种颜色的成品库存量为$s$，则对应的服务水平为$\eta=F(s)$。由$F_n$的定义知
\begin{equation}
F_n(ns) = P(D_n<ns) = P\left(\frac{\sum_{i=1}^nD_i}{n}<s\right)
\label{eq:Fn转为均值形式}
\end{equation}

根据中心极限定理，当$n\to\infty$时，$\frac{1}{n}\sum_{i=1}^nD_i$的分布趋近于正态分布$N(\mu,\sigma^2/n)$。设正态分布$N(\mu,\sigma^2/n)$的累积分布函数为$G$。由中心极限定理得
\begin{equation}
\lim_{n\to\infty}P\left(\frac{\sum_{i=1}^nD_i}{n}<s\right) = \lim_{n\to\infty}\Phi\left(\frac{s-\mu}{\sigma/\sqrt{n}}\right) = \lim_{n\to\infty}G(s)
\label{eq:中心极限定理}
\end{equation}
其中$\Phi$为标准正态分布的累积分布函数。由公式\ref{eq:Fn转为均值形式}和\ref{eq:中心极限定理}可知
\begin{equation}
\lim_{n\to\infty}[F_n(ns)-G(s)]=0
\label{eq:Fn与G的极限形式}
\end{equation}

接下来我们将证明，对任何的右偏斜需求分布，一定存在一个区间，当服务水平在此区间内时，就存在改进失效的可能。已知需求$D_i$的分布是右偏的，因此有
\begin{equation}
F(\mu) > 0.5 = \Phi(0) = G(\mu)
\label{eq:右偏斜的性质}
\end{equation}
由$F$和$G$的连续性，至少存在一个$\mu$的领域$[\mu,s_0)$，使得这个区间内的所有库存值$s$都满足
\[
F(s) > G(s),\qquad \forall s\in[\mu,s_0)
\]
令$\delta=F(s)-G(s)>0$。在公式\ref{eq:Fn与G的极限形式}中，根据极限的定义，存在一个正数$N$，使得对任意的$n>N$，都有
\begin{equation}
|F_n(ns)-G(s)| < \delta = F(s) - G(s)
\label{eq:根据极限的定义}
\end{equation}
公式\ref{eq:根据极限的定义}显示，对于任意的$s\in[\mu,s_0)$，都存在一个$N$，使得$n>N$时恒有$F_n(ns)<F(s)$。

我们知道$F(s)$代表需求量小于$s$的概率，即库存量$s$对应的服务水平。反过来，某个服务水平$\eta$也对应着一个库存量，我们将这个对应关系定义为函数$F^{-1}$。函数$F^{-1}$的表达式为
\[
F^{-1}(\eta) = \inf\left\{s\middle|F(s)\geq\eta\right\}
\]
其中$\inf$表示集合的下确界。同理可定义$F_n^{-1}$。

若企业需要满足的服务水平为$\eta$，则改进前和改进后的库存分别为$F^{-1}(\eta)$和$F_n^{-1}(\eta)$。若改进后的在制品库存大于改进前的各颜色成品库存之和，就说明改进失效了。也就是说，改进失效的具体表现是$F_n^{-1}(\eta)>nF^{-1}(\eta)$。下面我们将证明，当$F^{-1}(\eta)\in[\mu,s_0)$时，存在改进失效的可能。

现在假设企业的设定的服务水平为$\eta$，满足$\eta\in[F(\mu),F(s_0))$，则改进前各颜色成品的库存为$s=F^{-1}(\eta)\in[\mu,s_0)$。前面已经证明，对于任意的$s\in[\mu,s_0)$，都存在一个$N$，使得$n>N$时恒有
\begin{equation}
F_n(ns)<F(s)=\eta
\label{eq:改进前后服务水平的关系}
\end{equation}
根据反函数的性质，由于累积分布函数$F$和$F_n$是单调递增的，所以$F^{-1}$和$F_n^{-1}$也是单调递增的。公式\ref{eq:改进前后服务水平的关系}显示$F_n(ns)<\eta$，结合$F_n^{-1}$的单调性可知
\begin{equation}
F_n^{-1}(\eta) > ns
\label{eq:反函数单调性}
\end{equation}
把$s=F^{-1}(\eta)$代入公式\ref{eq:反函数单调性}有
\[
F_n^{-1}(\eta)>nF^{-1}(\eta)
\]
前面已经提到，上式即为改进失效的具体表现。

通过本节的分析，我们证明了，当各颜色成品需求服从独立同分布的任意一种右偏斜分布时，存在一个大于$F^{-1}(\mu)$的服务水平区间，企业的服务水平位于这个区间时，存在改进失效的可能。当服务水平小于$F^{-1}(\mu)$时，安全库存是负值，无需过多讨论。








\section{任何服务水平都存在改进失效的可能}

在上一节的讨论中，我们已经证明，如果需求服从独立同分布的右偏斜分布，则存在一个大于0.5的服务水平区间，









\section{第二类服务水平下不会发生改进失效}




















